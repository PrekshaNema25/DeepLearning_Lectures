\begin{tikzpicture}
\node (H) [text width=\textwidth] at ($ (R) + (0,2) $) {\begin{table}
\begin{tabular}{l!{\color{white}\vrule}l!{\color{white}\vrule}l!{\color{white}\vrule}l!{\color{white}\vrule}l!{\color{white}\vrule}l!{\color{white}\vrule}l!{\color{white}\vrule}l!{\color{white}\vrule}l!{\color{white}\vrule}l}
\hline
\rowcolor{blue!50}
 .&.&.&.&.&.&.&.&.&.\\
\hline
\end{tabular}
\end{table}
};

\draw [fill=black!30] ($(H) + (-2.1, -2.4)$) rectangle ($(H) + (0,-2)$);
\draw [fill=black!30] ($(H) + (0, -2.4)$) rectangle ($(H) + (2.1,-2)$);

%\draw [fill=black!30] ($(H) + (-2.1, -3.3)$) rectangle ($(H) + (-0.2,-3)$);
%\draw [fill=black!30] ($(H) + (0.2, -3.3)$) rectangle ($(H) + (2.1,-3)$);

\node(V) [text width=\textwidth] at ($ (H) + (0,1.5) $) {\large{\begin{table}
\begin{tabular}{l!{\color{white}\vrule}l!{\color{white}\vrule}l!{\color{white}\vrule}l!{\color{white}\vrule}l!{\color{white}\vrule}l!{\color{white}\vrule}l!{\color{white}\vrule}l!{\color{white}\vrule}l!{\color{white}\vrule}l!{\color{white}\vrule}l!{\color{white}\vrule}l}
\hline
\rowcolor{red!50}
 .&.&.&.&.&.&.&.&.&.&.&.\\
\hline
\end{tabular}
\end{table}}
};

\node[text width=0.15\textwidth, rotate=90] at ($(V) + (-3,0.9)$ ) {\tiny{$P(he|sat,he)$}};
\node[text width=0.15\textwidth, rotate=90] at ($(V) + (-2.5,0.9)$ ) {\tiny{$P(chair|sat,he)$}};
\node[text width=0.15\textwidth, rotate=90] at ($(V) + (-2.0,0.9)$ ) {\tiny{$P(man|sat,he)$}};
\draw[line width=0.5, color = blue!50] [->] ($(V) + (-2.0,0.2)$) -- ($(V) + (-2.0, 0.4)$);
\draw[line width=0.5, color = blue!50] [->] ($(V) + (-2.5,0.2)$) -- ($(V) + (-2.5, 0.4)$);
\draw[line width=0.5, color = blue!50] [->] ($(V) + (-3.0,0.2)$) -- ($(V) + (-3.0, 0.4)$);
\node[text width=0.15\textwidth, rotate=90] at ($(V) + (1.4,0.9)$ ) {\tiny\textcolor{red}{{$P(on|sat,he)$}}};
\draw[line width=0.5, color = blue!50] [->] ($(V) + (1.4,0.2)$) -- ($(V) + (1.4, 0.4)$);

\node[text width=0.1\textwidth, ] at ($(V) + (-1.0,0.9)$ ) {.};
\node[text width=0.1\textwidth, ] at ($(V) + (-0.5,0.9)$ ) {.};
\node[text width=0.1\textwidth, ] at ($(V) + (0,0.9)$ ) {.};
\node[text width=0.1\textwidth, ] at ($(V) + (0.5,0.9)$ ) {.};
\node[text width=0.1\textwidth, ] at ($(V) + (1.1,0.9)$ ) {.};
\node[text width=0.1\textwidth, ] at ($(V) + (2,0.9)$ ) {.};
\node[text width=0.1\textwidth, ] at ($(V) + (2.5,0.9)$ ) {.};
\node[text width=0.1\textwidth, ] at ($(V) + (3.0,0.9)$ ) {.};
\node[text width=0.1\textwidth, ] at ($(V) + (3.5,0.9)$ ) {.};


%\draw[line width=1][->] ($(H) + (-1,-3)$) -- ($(H) + (-1,-2.4)$);
%\draw[line width=1][->] ($(H) + (1,-3)$) -- ($(H) + (1,-2.4)$);
\node at ($ (H) + (-1,-2.6)$){\textit{he}};
\node at ($ (H) + (1,-2.6)$){\textit{sat}};
%\node[text width = 0.2\textwidth] at ($(H) + (-0.3, -2.7)$){\tiny{$W_{context}$}};
%\node[text width = 0.2\textwidth] at ($(H) + (1.3, -2.7)$){\tiny{$W_{context}$}};
\node[text width=0.3\textwidth, ] at ($(H) + (3.8,0)$ ) {\tiny{$\mathbf{h} \in \mathbb{R}^{k}$}};
\node[text width=0.3\textwidth, ] at ($(H) + (0.3,0.7)$ ) {\tiny{$W_{word} \in \mathbb{R}^{k\times 2|V|}$}};
\node[text width=0.3\textwidth, ] at ($(0,1) + (3.3,1.8)$ ) {\tiny{$\mathbf{x} \in \mathbb{R}^{2|V|}$}};
\node[text width = 0.3\textwidth] at (0.1, 3.8){\tiny{$[W_{context},W_{context}] \in \mathbb{R}^{k\times 2|V|}$}};

\draw[line width=0.8,color=blue!50] (-2.125,3) -- (-2.7,4.7);
\draw[line width=0.8,color=blue!50] (2.125,3) -- (2.7,4.7);

\draw[line width=0.8,color=red!50] (-2.67,5.2) -- (-3.29,6.21);
\draw[line width=0.8,color=red!50] (2.67,5.2) -- (3.29,6.21);
\end{tikzpicture}
